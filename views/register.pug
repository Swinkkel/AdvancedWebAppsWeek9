extends layout

block content
    h1 Registration page 
    div.container 
        form(action="/api/user/register" method="POST" onsubmit="handleSubmit(event)")
        div
            label(for="email") Email:
            input(type="email" name="email" required)
        div
            label(for="password") Password:
            input(type="password" name="password" required)
        div
            button(type="submit") Register

    script.
        async function handleSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            const response = await fetch(form.action, {
                method: form.method,
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                window.location.href = "/login.html";
            } else {
                const errorData = await response.json();
                alert(`Registration failed: ${errorData.errors ? errorData.errors.map(e => e.msg).join(', ') : errorData.email}`);
            }
        }
